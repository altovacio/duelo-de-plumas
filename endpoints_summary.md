# Backend Endpoint Summary (Revised)

This document summarizes the backend endpoints, aligning them with the plan outlined in `api_roles_and_features.md`. It notes the intended role access and highlights endpoints needing refinement or potentially marked for deletion.

## Key from `api_roles_and_features.md`

*   **Public:** Accessible to Visitors, Users, Admins.
*   **Authenticated:** Accessible to logged-in Users and Admins.
*   **Admin-Only:** Accessible only to Admins.
*   **User-Owner:** Requires User role and ownership of the resource.
*   **User-Judge:** Requires User role and assignment as Judge for the specific contest.
*   **Refine:** Endpoint exists but needs logic/permission adjustments.
*   **Missing:** Feature required by plan but no dedicated endpoint exists yet.

## Existing Endpoints Table

| Method | Path                                                      | Summary/Purpose                     | Original Auth | Planned Status/Notes (`api_roles_and_features.md` Ref)                                                                                                     | Router File | 
| :----- | :-------------------------------------------------------- | :---------------------------------- | :------------ | :--------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------- | 
| **GET**  | `/`                                                       | Main root (placeholder)             | Public        | Keep (Likely serves frontend)                                                                                                                              | `main.py`     | 
| **POST** | `/auth/token`                                             | Login for access token              | Public        | Keep (Public)                                                                                                                                              | `auth.py`     | 
| **GET**  | `/auth/users/me`                                          | Get current authenticated user      | User          | Keep (Authenticated) - Scope check: Should return basic info (id, username, email, role). Dashboard data needs separate endpoint.                           | `auth.py`     | 
| **POST** | `/auth/register`                                          | Register new user                   | Public        | Keep (Public)                                                                                                                                              | `auth.py`     | 
| **POST** | `/contests/`                                              | Create contest                      | Admin         | **Refine** (Authenticated / User-Owner or Admin) - Needs check for User role.                                                                              | `contest.py`  | 
| **GET**  | `/contests/`                                              | List contests                       | Optional      | Keep (Public) - Verify public access works without login.                                                                                                  | `contest.py`  | 
| **GET**  | `/contests/{contest_id}`                                  | Get contest details                 | Optional      | **Refine** (Public/Authenticated) - Verify public access. Private needs password check/role. Admin override.                                             | `contest.py`  | 
| **PUT**  | `/contests/{contest_id}`                                  | Update contest                      | Admin         | **Refine** (Authenticated / User-Owner or Admin) - Needs ownership check for Users.                                                                        | `contest.py`  | 
| **DELETE**| `/contests/{contest_id}`                                  | Delete contest                      | Admin         | **Refine** (Authenticated / User-Owner or Admin) - Needs ownership check for Users.                                                                        | `contest.py`  | 
| **POST** | `/contests/{contest_id}/submissions`                      | Submit entry to contest             | Optional      | **Refine** (Authenticated / User or Admin) - Needs role check (User for open contests, Admin anytime).                                                     | `contest.py`  | 
| **GET**  | `/contests/{contest_id}/submissions`                      | Get contest submissions             | Judge/Admin   | **Refine** (Authenticated / User-Judge or Admin) - Needs check for User assignment as judge + contest state logic. Needs Admin override/full access. | `contest.py`  | 
| **POST** | `/contests/{contest_id}/check-password`                   | Check password for private contest  | Public        | Keep (Public) - Verify logic.                                                                                                                              | `contest.py`  | 
| **POST** | `/contests/{contest_id}/evaluate`                         | Submit judge evaluation             | Judge         | **Refine** (Authenticated / User-Judge or Admin) - Needs check for User assignment as judge + contest state logic (evaluation). Needs Admin override.     | `contest.py`  | 
| **GET**  | `/admin/users/`                                           | List users (filterable)             | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **POST** | `/admin/users/`                                           | Create Human Judge user             | Admin         | **Refine** (Admin-Only) - Modify to create standard 'user' or 'admin' roles.                                                                               | `admin.py`    | 
| **GET**  | `/admin/ai-writers`                                       | List AI Writers (Global)            | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **POST** | `/admin/ai-writers`                                       | Create AI Writer (Global)           | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **GET**  | `/admin/ai-writers/{writer_id}`                           | Get AI Writer details (Global)      | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **PUT**  | `/admin/ai-writers/{writer_id}`                           | Update AI Writer (Global)           | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **DELETE**| `/admin/ai-writers/{writer_id}`                           | Delete AI Writer (Global)           | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **PUT**  | `/admin/contests/{contest_id}/status`                     | Set contest status                  | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **PUT**  | `/admin/contests/{contest_id}/reset-password`             | Reset private contest password      | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **GET**  | `/admin/ai-judges`                                        | List AI Judges (Global)             | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **POST** | `/admin/ai-judges`                                        | Create AI Judge (Global)            | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **GET**  | `/admin/ai-judges/{ai_judge_id}`                          | Get AI Judge details (Global)       | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **PUT**  | `/admin/ai-judges/{ai_judge_id}`                          | Update AI Judge (Global)            | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **DELETE**| `/admin/ai-judges/{ai_judge_id}`                          | Delete AI Judge (Global)            | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **POST** | `/admin/contests/{contest_id}/human-judges/{user_id}`     | Assign Human User as Judge          | Admin         | Keep (Admin-Only) - Assigns contest-specific permission to a User.                                                                                         | `admin.py`    | 
| **DELETE**| `/admin/contests/{contest_id}/human-judges/{user_id}`     | Unassign Human User as Judge        | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **POST** | `/admin/contests/{contest_id}/ai-judges/{ai_judge_id}`    | Assign AI Judge                     | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **DELETE**| `/admin/contests/{contest_id}/ai-judges/{ai_judge_id}`    | Unassign AI Judge                   | Admin         | Keep (Admin-Only) - Note: Also exists in `contest.py` (marked for deletion).                                                                               | `admin.py`    | 
| **GET**  | `/admin/ai-evaluations`                                   | List AI Evaluations                 | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **GET**  | `/admin/ai-evaluations/{evaluation_id}`                   | Get AI Evaluation Details           | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **GET**  | `/admin/ai-costs-summary`                                 | Get AI Costs Summary                | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **POST** | `/admin/contests/{contest_id}/ai-submission`            | Trigger AI Submission generation    | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 
| **DELETE**| `/admin/submissions/{submission_id}`                      | Delete a submission                 | Admin         | **Refine** (Authenticated / User-Owner or Admin) - Needs ownership check for Users.                                                                        | `admin.py`    | 
| **POST** | `/admin/contests/{contest_id}/ai-judges/{ai_judge_id}/evaluate` | Trigger AI Judge Evaluation (Admin) | Admin         | Keep (Admin-Only)                                                                                                                                          | `admin.py`    | 

## Endpoints Marked for Potential Deletion

These endpoints appear redundant, out of scope, or duplicated based on the plan in `api_roles_and_features.md`. Review usage before removing.

| Method | Path                                                   | Reason for Potential Deletion                                        | Router File   | 
| :----- | :----------------------------------------------------- | :------------------------------------------------------------------- | :------------ | 
| GET    | `/submissions/`                                        | Vague purpose, likely covered by contest/dashboard endpoints.        | `main.py`     | 
| GET    | `/dashboard-data`                                      | Vague purpose, should be replaced by specific User/Admin dashboards. | `main.py`     | 
| GET    | `/roadmap/items`                                       | Out of scope for core Utopia features?                               | `main.py`     | 
| POST   | `/roadmap/item`                                        | Out of scope for core Utopia features?                               | `main.py`     | 
| DELETE | `/roadmap/item/{item_id}`                              | Out of scope for core Utopia features?                               | `main.py`     | 
| PUT    | `/roadmap/item/{item_id}/status`                       | Out of scope for core Utopia features?                               | `main.py`     | 
| DELETE | `/contests/{contest_id}/ai-judges/{ai_judge_id}`       | Duplicates `/admin/contests/{contest_id}/ai-judges/{ai_judge_id}`. | `contest.py`  | 
| POST   | `/ai/generate-text`                                    | Vague internal trigger? User requests & Admin triggers have specific endpoints. | `ai_router.py`| 
